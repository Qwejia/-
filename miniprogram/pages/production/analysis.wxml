<view class="container">
  <!-- 操作栏 -->
  <view class="action-bar">
    <text class="page-title">生产分析</text>
    <button class="export-btn" bindtap="exportAnalysisReport">导出报告</button>
  </view>

  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading">
    <text>加载中...</text>
  </view>

  <!-- 生产分析内容 -->
  <view wx:else class="analysis-content">
    <!-- 生产统计卡片 -->
    <view class="stats-cards">
      <view class="stat-card">
        <view class="stat-value">{{productionStats.totalPlans}}</view>
        <view class="stat-label">计划总数</view>
      </view>
      <view class="stat-card">
        <view class="stat-value">{{productionStats.completedPlans}}</view>
        <view class="stat-label">已完成计划</view>
      </view>
      <view class="stat-card">
        <view class="stat-value">{{productionStats.inProgressPlans}}</view>
        <view class="stat-label">进行中计划</view>
      </view>
      <view class="stat-card">
        <view class="stat-value">{{productionStats.totalProduction}}</view>
        <view class="stat-label">总产量</view>
      </view>
    </view>

    <!-- 生产趋势 -->
    <view class="section">
      <view class="section-title">生产趋势</view>
      <view class="trend-list">
        <view 
          wx:for="{{productionTrend}}" 
          wx:key="month"
          class="trend-item"
        >
          <view class="trend-month">{{item.month}}</view>
          <view class="trend-bar">
            <view class="bar" style="width: {{item.value / 3000 * 100}}%; height: 24rpx; background-color: #1890ff;"></view>
          </view>
          <view class="trend-value">{{item.value}}</view>
        </view>
      </view>
    </view>

    <!-- 计划状态分布 -->
    <view class="section">
      <view class="section-title">计划状态分布</view>
      <view class="status-distribution">
        <view class="status-item">
          <text class="status-label">已完成:</text>
          <text class="status-value">{{productionStats.completedPlans}} ({{Math.round(productionStats.completedPlans / productionStats.totalPlans * 100)}}%)</text>
        </view>
        <view class="status-item">
          <text class="status-label">进行中:</text>
          <text class="status-value">{{productionStats.inProgressPlans}} ({{Math.round(productionStats.inProgressPlans / productionStats.totalPlans * 100)}}%)</text>
        </view>
        <view class="status-item">
          <text class="status-label">待开始:</text>
          <text class="status-value">{{productionStats.pendingPlans}} ({{Math.round(productionStats.pendingPlans / productionStats.totalPlans * 100)}}%)</text>
        </view>
      </view>
    </view>
  </view>
</view>