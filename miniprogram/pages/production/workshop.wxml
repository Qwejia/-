<view class="container">
  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading">
    <text>加载中...</text>
  </view>

  <!-- 车间管理内容 -->
  <view wx:else class="workshop-content">
    <!-- 车间列表 -->
    <view class="section">
      <view class="section-title">车间列表</view>
      <view class="workshop-list">
        <view 
          wx:for="{{workshops}}" 
          wx:key="workshopId"
          class="workshop-item"
          data-workshop-id="{{item.workshopId}}"
          bindtap="viewWorkshopDetail"
        >
          <view class="workshop-name">{{item.name}}</view>
          <view class="workshop-info">
            <text>编码: {{item.workshopId}}</text>
            <text class="divider">|</text>
            <text>主管: {{item.managerName}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 车间工单 -->
    <view class="section">
      <view class="section-title">车间工单</view>
      <view class="workshop-order-list">
        <view 
          wx:for="{{workshopOrders}}" 
          wx:key="orderNumber"
          class="workshop-order-item"
          data-order-id="{{item._id}}"
          bindtap="viewWorkshopOrderDetail"
        >
          <view class="order-header">
            <view class="order-number">{{item.orderNumber}}</view>
            <view class="order-workshop">{{item.workshopName}}</view>
          </view>
          <view class="order-body">
            <view class="order-info">
              <text class="info-label">产品名称:</text>
              <text class="info-value">{{item.productName}}</text>
            </view>
            <view class="order-progress">
              <text class="progress-label">完成进度:</text>
              <text class="progress-value">{{item.completedQuantity}}/{{item.quantity}} ({{Math.round(item.completedQuantity / item.quantity * 100)}}%)</text>
            </view>
          </view>
          <view class="order-footer">
            <text class="status-tag" style="background-color: {{item.status === 'completed' ? '#e8f5e9' : item.status === 'inProgress' ? '#e3f2fd' : '#fff3e0'}}; color: {{item.status === 'completed' ? '#2e7d32' : item.status === 'inProgress' ? '#1565c0' : '#ef6c00'}};">
              {{item.status === 'completed' ? '已完成' : item.status === 'inProgress' ? '进行中' : '待开始'}}
            </text>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>