<view class="container">
  <!-- 操作栏 -->
  <view class="action-bar">
    <text class="page-title">销售分析</text>
    <button class="export-btn" bindtap="exportAnalysisReport">导出报告</button>
  </view>

  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading">
    <text>加载中...</text>
  </view>

  <!-- 销售分析内容 -->
  <view wx:else class="analysis-content">
    <!-- 销售统计卡片 -->
    <view class="stats-cards">
      <view class="stat-card">
        <view class="stat-value">{{salesStats.totalOrders}}</view>
        <view class="stat-label">订单总数</view>
      </view>
      <view class="stat-card">
        <view class="stat-value">{{salesStats.completedOrders}}</view>
        <view class="stat-label">已完成订单</view>
      </view>
      <view class="stat-card">
        <view class="stat-value">{{salesStats.pendingOrders}}</view>
        <view class="stat-label">待处理订单</view>
      </view>
      <view class="stat-card">
        <view class="stat-value">¥{{salesStats.totalAmount.toLocaleString()}}</view>
        <view class="stat-label">销售总额</view>
      </view>
    </view>

    <!-- 销售趋势 -->
    <view class="section">
      <view class="section-title">销售趋势</view>
      <view class="trend-list">
        <view 
          wx:for="{{salesTrend}}" 
          wx:key="month"
          class="trend-item"
        >
          <view class="trend-month">{{item.month}}</view>
          <view class="trend-bar">
            <view class="bar" style="width: {{item.value / 300000 * 100}}%; height: 24rpx; background-color: #1890ff;"></view>
          </view>
          <view class="trend-value">¥{{item.value.toLocaleString()}}</view>
        </view>
      </view>
    </view>

    <!-- 客户销售统计 -->
    <view class="section">
      <view class="section-title">客户销售统计</view>
      <view class="customer-stats-list">
        <view 
          wx:for="{{customerStats}}" 
          wx:key="customerName"
          class="customer-stats-item"
        >
          <view class="customer-name">{{item.customerName}}</view>
          <view class="customer-stats">
            <text class="stats-label">订单数:</text>
            <text class="stats-value">{{item.orderCount}}</text>
            <text class="divider">|</text>
            <text class="stats-label">销售额:</text>
            <text class="stats-value price">¥{{item.totalAmount.toLocaleString()}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>