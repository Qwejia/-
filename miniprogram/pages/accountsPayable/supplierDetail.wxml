<view class="container">
  <view class="header">
    <text class="title">供应商详情</text>
    <button class="edit-btn" bindtap="goToEdit">编辑</button>
  </view>

  <view wx:if="{{supplier}}" class="supplier-card">
    <view class="supplier-basic-info">
      <text class="supplier-name">{{supplier.name}}</text>
      <text class="supplier-code">({{supplier.code}})</text>
      <view class="status-badge {{supplier.status === 'active' ? 'active' : 'inactive'}}">
        {{supplier.status === 'active' ? '正常' : '停用'}}
      </view>
    </view>

    <view class="supplier-contact-info">
      <view class="info-item">
        <text class="label">联系人：</text>
        <text class="value">{{supplier.contact}}</text>
      </view>
      <view class="info-item">
        <text class="label">电话：</text>
        <text class="value">{{supplier.phone}}</text>
      </view>
      <view class="info-item">
        <text class="label">地址：</text>
        <text class="value">{{supplier.address}}</text>
      </view>
      <view class="info-item">
        <text class="label">信用额度：</text>
        <text class="value">{{supplier.creditLimit.toLocaleString()}} 元</text>
      </view>
    </view>
  </view>

  <view class="summary-section">
    <text class="section-title">业务统计</text>
    <view class="summary-cards">
      <view class="summary-card">
        <text class="summary-label">应付总额</text>
        <text class="summary-value">{{totalAmount.toLocaleString()}} 元</text>
      </view>
      <view class="summary-card">
        <text class="summary-label">已付总额</text>
        <text class="summary-value">{{totalPaid.toLocaleString()}} 元</text>
      </view>
      <view class="summary-card">
        <text class="summary-label">应付余额</text>
        <text class="summary-value balance">{{totalBalance.toLocaleString()}} 元</text>
      </view>
    </view>
  </view>

  <view class="action-section">
    <button class="action-btn add-invoice" bindtap="addApInvoice">+ 新增应付单</button>
    <button class="action-btn add-payment" bindtap="addApPayment">+ 新增付款单</button>
  </view>

  <view class="transactions-section">
    <view class="section-header">
      <text class="section-title">最近应付单</text>
      <button class="view-all-btn" bindtap="goToApInvoiceList">查看全部</button>
    </view>
    <view class="transaction-list">
      <view wx:if="{{apInvoices.length === 0}}" class="empty">
        <text>暂无应付单记录</text>
      </view>
      <block wx:for="{{apInvoices}}" wx:key="_id" wx:for-item="invoice">
        <view class="transaction-item" bindtap="viewApInvoice" data-id="{{invoice._id}}">
          <view class="transaction-info">
            <text class="transaction-number">应付单：{{invoice.code}}</text>
            <text class="transaction-date">{{invoice.invoiceDate}}</text>
          </view>
          <view class="transaction-amount">
            <text class="amount">{{invoice.amount.toLocaleString()}} 元</text>
            <text class="status {{invoice.status === 'unpaid' ? 'unpaid' : 'paid'}}">
              {{invoice.status === 'unpaid' ? '未付' : '已付'}}
            </text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <view class="transactions-section">
    <view class="section-header">
      <text class="section-title">最近付款单</text>
      <button class="view-all-btn" bindtap="goToApPaymentList">查看全部</button>
    </view>
    <view class="transaction-list">
      <view wx:if="{{apPayments.length === 0}}" class="empty">
        <text>暂无付款单记录</text>
      </view>
      <block wx:for="{{apPayments}}" wx:key="_id" wx:for-item="payment">
        <view class="transaction-item" bindtap="viewApPayment" data-id="{{payment._id}}">
          <view class="transaction-info">
            <text class="transaction-number">付款单：{{payment.code}}</text>
            <text class="transaction-date">{{payment.paymentDate}}</text>
          </view>
          <view class="transaction-amount">
            <text class="amount">{{payment.amount.toLocaleString()}} 元</text>
            <text class="status paid">已付</text>
          </view>
        </view>
      </block>
    </view>
  </view>
</view>