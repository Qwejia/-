<!-- pages/generalLedger/voucherList.wxml -->
<view class="container">
  <!-- æœç´¢æ  -->
  <view class="search-section">
    <view class="search-box">
      <text class="search-icon">ğŸ”</text>
      <input type="text" placeholder="æœç´¢å‡­è¯ç¼–å·" value="{{searchKeyword}}" bindinput="onSearch" class="search-input" />
    </view>
  </view>
  
  <!-- ç­›é€‰æ¡ä»¶ -->
  <view class="filter-section">
    <view class="filter-row">
      <view class="filter-item">
        <text class="label">çŠ¶æ€</text>
        <picker mode="selector" range="{{statusOptions}}" range-key="text" value="{{statusFilter}}" bindchange="onStatusChange" class="picker">
          <view class="picker-text">{{statusOptions[statusFilter].text}}</view>
        </picker>
      </view>
      <view class="filter-item">
        <text class="label">å¼€å§‹æ—¥æœŸ</text>
        <picker mode="date" value="{{dateRange.start}}" bindchange="onStartDateChange" class="picker">
          <view class="picker-text">{{dateRange.start || 'é€‰æ‹©æ—¥æœŸ'}}</view>
        </picker>
      </view>
      <view class="filter-item">
        <text class="label">ç»“æŸæ—¥æœŸ</text>
        <picker mode="date" value="{{dateRange.end}}" bindchange="onEndDateChange" class="picker">
          <view class="picker-text">{{dateRange.end || 'é€‰æ‹©æ—¥æœŸ'}}</view>
        </picker>
      </view>
    </view>
    <view class="reset-btn">
      <button type="default" bindtap="resetFilters" size="mini">é‡ç½®ç­›é€‰</button>
    </view>
  </view>
  
  <!-- å‡­è¯åˆ—è¡¨ -->
  <view class="vouchers-section">
    <view class="section-header">
      <text class="title">å‡­è¯åˆ—è¡¨</text>
      <text class="count">({{filteredVouchers.length}})</text>
    </view>
    
    <view class="vouchers-list">
      <view wx:for="{{filteredVouchers}}" wx:key="_id" class="voucher-item" bindtap="viewVoucherDetail" data-id="{{item._id}}">
        <view class="voucher-header">
          <view class="voucher-info">
            <text class="voucher-number">{{item.number}}</text>
            <text class="voucher-date">{{item.date}}</text>
          </view>
          <view class="voucher-status {{item.status}}">
            {{item.status === 'draft' ? 'è‰ç¨¿' : item.status === 'submitted' ? 'å·²æäº¤' : item.status === 'approved' ? 'å·²å®¡æ ¸' : 'å·²è®°è´¦'}}
          </view>
        </view>
        <view class="voucher-amounts">
          <view class="amount-item">
            <text class="label">å€Ÿæ–¹é‡‘é¢</text>
            <text class="amount debit">Â¥{{item.totalDebit.toFixed(2)}}</text>
          </view>
          <view class="amount-item">
            <text class="label">è´·æ–¹é‡‘é¢</text>
            <text class="amount credit">Â¥{{item.totalCredit.toFixed(2)}}</text>
          </view>
        </view>
        <view class="voucher-actions">
          <button wx:if="item.status === 'draft' || item.status === 'submitted'" type="primary" size="mini" bindtap="approveVoucher" data-id="{{item._id}}">å®¡æ ¸</button>
          <button wx:if="item.status === 'approved'" type="primary" size="mini" bindtap="postVoucher" data-id="{{item._id}}">è®°è´¦</button>
          <button type="default" size="mini" bindtap="viewVoucherDetail" data-id="{{item._id}}">æŸ¥çœ‹è¯¦æƒ…</button>
        </view>
      </view>
      
      <view wx:if="filteredVouchers.length === 0" class="empty-state">
        <text class="empty-text">æš‚æ— å‡­è¯æ•°æ®</text>
      </view>
    </view>
  </view>
  
  <!-- æ–°å¢æŒ‰é’® -->
  <view class="add-button">
    <button type="primary" bindtap="addVoucher" class="btn">+ æ–°å¢å‡­è¯</button>
  </view>
</view>
